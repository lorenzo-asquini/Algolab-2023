# Planet Express - solution

It would be wasteful to iterate over all the warehouses, using the Dijkstra shortest path algorithm, to find which one reaches the final planet in less time. It is much better to create the graph by inverting all the edge directions and using Dijkstra starting from the final planet. It is then possible to iterate on all the warehouses and see which one is the closest.

There are some planets with teleportation systems, but that does not necessarily mean that they are connected to other planets through teleportation. A planet is connected through teleportation to another planet if the two planets are connected both ways using normal routes. For this reason, it is necessary to find the strong connected components of the graph, each strong component representing a sub-network in which all planets with teleportation are connected. After finding the strong connected components, it is necessary to count how many teleportation planets are present in each sub-network. Then, it is necessary to connect with edges both ways all the teleportation planets inside a sub-network with a travel time equal to the number of teleportation planets in the sub-network minus one (all the teleportation planets in a strong connected component are connected with the same amount of teleportation planets).

However, this is not fast enough for the last testcase because there are many connections made inside each strong connected component. Potentially, there could be $T \cdot (T-1)$ new edges, and this would require too many operations and additions. For this reason, it is necessary to add a dummy vertex for each strong connected component (no need to worry about the graph; new nodes are added automatically). This dummy node will work as a hub for teleportation. Going to this node will cost 0, and coming back from this node will cost the right amount of milliseconds calculated as described. In a strong connected component, to travel from a planet with teleportation to another with teleportation, $X$ microseconds are necessary. With the dummy node, $X+0$ microseconds are necessary. The dummy planet must be specific to a strong connected component and outside the realm of normal planets, so its ID may be `n+scc_map[p]`, where `p` is the planet with teleportation considered and `scc_map[p]` is the strong connected component identifier of the planet `p`. Keep in mind that the target planet should be calculated from the original $n$, not the one that can be requested from the graph, which now has more vertices.

After completing the graph, it is possible to find the shortest path. It is necessary to check that the total time is less than or equal to 1 million.