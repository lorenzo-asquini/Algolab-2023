# Lannister - solution

It's necessary to build a water canal that is non-vertical and a sewage canal that is non-horizontal, making sure that the two are perpendicular to each other. Water pipes that connect to the water canal are always vertical, and sewage pipes that connect to the sewage canal are always horizontal. This is a linear programming problem where it's necessary that the inequalities depend on the equation of the two lines that describe the canals. The water canal is described with the equation $a_w \cdot x + b_w \cdot y + c_w = 0$, with $b_w \neq 0$ to make it non-vertical. The sewage canal is described with the equation $a_s \cdot x + b_s \cdot y + c_s = 0$, with $a_s \neq 0$ to make it non-horizontal.
  
Firstly, it's necessary to place the nobles on the left of the sewage canal and the commons on its right. Nobles are on the left if it's true that $a_s \cdot x_n + b_s \cdot y_n + c_s \leq 0$ and commons are on the right if it's true that $-a_s \cdot x_c - b_s \cdot y_c - c_s \leq 0$ (to make sure the signs are correct, try using a fake line $x = 0$, that means $a_s = 1, b_s = 0, c_s = 0$ and inserting possible points in the plane that should be on the right or on the left. It applies even if the line is tilted). These inequalities, as they are, would result in $a_s = 0, b_s = 0, c_s = 0$ because $0 \leq 0$. It's not possible to use the trick of creating a boundary around the line because houses on top of the line are allowed. So, the technique to use is setting $a_s = 1$ (or any other number that is not zero). This both forces the line to be non-horizontal and makes sure that the line has coefficients that are not all zeros. It's possible to do so because it's possible to divide all coefficients by $a_s$ (if it's different from zero) without changing the final line, considering that the coefficients $b_s$ and $c_s$ still don't have a defined value, and it does not matter what value they get. At this point, if the problem is not feasible, the answer is _Yuck!_.

The second part requires calculating the distance of each house to the sewage canal. Considering that the sewage pipes are only horizontal, the distance is the difference between the $x_h$ coordinate of the house and the $x$ coordinate of the line at the same $y_h$ coordinate of the house. Given that $a_s = 1$, the $x$ coordinate of the line at the point of collision is $x = - b_s \cdot y_h - c_s$. Nobles are always on the left at this point, so the length of the sewage pipe is $- b_s \cdot y_h - c_s - x_h$ (which is positive). Commons are always on the right at this point, so the length of the sewage pipe is $x_h + b_s \cdot y_h + c_s$ (which is positive). The sum of all lengths is therefore $\sum_{COMMONS} (x_h) + b_s \cdot \sum_{COMMONS} (y_h) + m \cdot c_s - \sum_{NOBLES} (x_h) - b_s \cdot \sum_{NOBLES} (y_h) - n \cdot c_s$, which, if $s \neq -1$, must be smaller or equal than $s$. The sums of the coordinates can be calculated while reading the data. At this point, if the problem is not feasible, the answer is _Bankrupt!_.

The third part requires minimizing the length of the water pipes. First, it's necessary to force the water canal to be non-vertical, setting $b_w = 1$ (this works for the same reason as described above). To minimize the length of the water pipes, it's possible to create a new variable, $L$ (greater than zero), that will be minimized. Considering that the water pipes are only vertical, the distance is the difference between the $y_h$ coordinate of the house and the $y$ coordinate of the line at the same $x_h$ coordinate of the house. Given that $b_w = 1$, the $y$ coordinate of the line at the point of collision is $y = - a_w \cdot x_h - c_w$. However, now it's not possible to know if the result will be positive or negative, so it's necessary to use an absolute value. Given that the distance is $L = |y_h - y| = |y_h + a_w \cdot c_h + c_w|$, the inequality used to limit the lengths of the pipe is $|y_h + a_w \cdot c_h + c_w| \leq L$. The technique to use makes use of the fact that $s \geq |t|$ (with $s$ positive) can be written as $s \geq t$ and $s \geq -t$, which is always true because one of the two right terms will be negative, making the inequality useless, while the other one will be the correct one. This can be applied both to the houses of the nobles and the houses of the commons. At this point, it's necessary to set the objective function with the goal of minimizing $L$.

The last factor to consider is that the lines should be perpendicular. Two lines are perpendicular if the product of their slopes is $-1$. In this case, the slope of the sewage canal is $-\frac{1}{b_s}$ and the slope of the water canal is $-a_w$, meaning that it's necessary to have $b_s = -a_w \leftrightarrow b_s + a_w = 0$, which can be set using two inequalities as above.
